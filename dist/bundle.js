!function(e){function a(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,a),i.l=!0,i.exports}var t={};a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},a.p="",a(a.s=0)}([function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n=t(1),i=t(2),r=t(4),d=t(6),o=t.n(d);$(document).ready(function(){var e=document.createElement("div");e.innerHTML=o.a,document.body.appendChild(e);var a=Backbone.Router.extend({routes:{"":"login",home:"home",signUp:"signUp"},initialize:function(){Backbone.history.start()},home:function(){(new n.a).view.render()},login:function(){(new r.a).view.render()},signUp:function(){(new i.a).view.render()}});new a})},function(e,a,t){"use strict";function n(){function e(e,a){var t=n.view.grid.dataSource._data.length-1,i=new Date(n.view.grid.dataSource._data[t-1]?n.view.grid.dataSource._data[t-1].MonthToPay:"");i.setMonth(i.getMonth()+1),n.view.grid.dataSource._data[t].MonthToPay=i,n.view.grid.dataSource._data[t].ExchangeRate=n.view.grid.dataSource._data[t-1]?n.view.grid.dataSource._data[t-1].ExchangeRate:"";var r="MonthToPay"==a.field?"required":"",d=$("<input "+r+" validationMessage='Заполни дату' />");d.attr("name",a.field),d.appendTo(e),d.kendoDatePicker({depth:"MonthToPay"==a.field?"year":"day",start:"MonthToPay"==a.field?"year":"day",format:"MonthToPay"==a.field?"MMMM yyyy":"dd/MMMM/yy",min:new Date(2011,0,1),dateInput:!0}).data("kendoDatePicker")}function a(e,a){"AccruedSum"==a.field?$('<input class="k-input k-textbox" required min="100" validationMessage="Заполни сумму ЗП"/>').attr("name",a.field).appendTo(e):$('<input class="k-input k-textbox" disabled="disabled" min="100" validationMessage="Заполни сумму ЗП"/>').attr("name",a.field).appendTo(e)}function t(e,a){$("div > label[for='"+a.field+"']").hide(),e.hide()}var n=this,i=[];kendo.culture("ru-RU");var r=new kendo.data.DataSource({data:i,autoSync:!1,change:function(e){if("itemchange"==e.action){var a=e.items[0].toJSON();switch(e.field){case"AccruedSum":a.SumToPay=a.Prepayment?a.AccruedSum-a.Prepayment:a.AccruedSum,a.SumUSD=100*Math.floor(a.SumToPay/3/100),a.SumUAH=a.ExchangeRate?(a.SumToPay-a.SumUSD)*a.ExchangeRate:a.SumToPay-a.SumUSD+"$ - установи курс!",this.pushUpdate(a);break;case"ExchangeRate":a.SumUAH=a.SumUAH?(a.SumToPay-a.SumUSD)*a.ExchangeRate:0,this.pushUpdate(a);break;case"Prepayment":a.SumToPay=a.Prepayment?a.AccruedSum-a.Prepayment:a.AccruedSum,a.SumUSD=100*Math.floor(a.SumToPay/3/100),a.SumUAH=a.ExchangeRate?(a.SumToPay-a.SumUSD)*a.ExchangeRate:a.SumToPay-a.SumUSD+"$ - установи курс!",this.pushUpdate(a)}}},schema:{model:{id:"id",fields:{id:{defaultValue:function(){return kendo.guid()}},MonthToPay:{},AccruedSum:{},SumToPay:{},Prepayment:{},SumUAH:{},ExchangeRate:{},DateUAHPay:{},SumUSD:{},DateUSDPay:{}}}}}),d=Backbone.View.extend({el:"#content",initialize:function(){},render:function(){var n=this,i=$("<div></div>");this.$el.html(i),$.get("/home").done(function(d){if(d.data){var o=JSON.parse(d.data);r.data(o),n.grid=i.kendoGrid({theme:"material",toolbar:[{name:"create",text:"Добавить новую запись"},{name:"save",text:"Сохранить данные"}],dataSource:r,columns:[{field:"id",hidden:!0,editor:t},{field:"MonthToPay",title:"Месяц оплаты",editor:e,format:"{0: MMMM yyyy}"},{field:"AccruedSum",title:"Сумма начислено",editor:a},{field:"SumToPay",title:"Сумма к оплате",editor:a},{field:"Prepayment",title:"Сумма аванса"},{field:"SumUAH",title:"Сумма гривен"},{field:"ExchangeRate",title:"Курс"},{field:"DateUAHPay",title:"Дата получения UAH",editor:e,format:"{0: dd MMMM yyyy}"},{field:"SumUSD",title:"Сумма USD"},{field:"DateUSDPay",title:"Дата получения USD",editor:e,format:"{0: dd MMMM yyyy}"},{width:"200px"}],editable:{createAt:"bottom",mode:"popup"},height:600,rowTemplate:kendo.template($("#rowTemplate").html()),edit:function(e){n.popupWindow=e.container},dataBinding:function(e){"itemchange"===e.action&&(console.log("dataBinding"),console.log(e),kendo.bind(n.popupWindow,e.items[0]))},saveChanges:function(e){var a=e.sender.dataSource.data().toJSON();$.post("/saveData",{data:JSON.stringify(a)}).done(function(e){alert("Данные сохранены успешно!")})},change:function(){}}).data("kendoGrid")}else window.location.replace("/"),alert("Авторизируйтесь пожалуйста")})}});n.view=new d}a.a=n},function(e,a,t){"use strict";function n(){var e=this,a=Backbone.View.extend({el:"#content",initialize:function(){this.render()},events:{"submit form.formSingUp":"submitSignUp"},render:function(){this.$el.html(r.a)},submitSignUp:function(e){var a=$(e.target).find("input#inputLogin").val(),t=$(e.target).find("input#inputEmail").val(),n=$(e.target).find("input#inputPassword").val();return n!=$(e.target).find("input#confirmPassword").val()?(alert("Введенные пароли не совпадают!"),!1):($.post("/signup",{username:a,password:n,email:t}).done(function(e){window.location.replace("#home")}).fail(function(e){alert(e)}),!1)},signUp:function(){window.location.replace(window.location.href+"#signUp")}});e.view=new a}var i=t(3),r=t.n(i);a.a=n},function(e,a){e.exports='<div class=container> <form class="form-signin formSingUp"> <h2 class=form-signin-heading>Пожалуйста заполните форму регистрации:</h2> <label for=inputLogin class=sr-only>Логин</label> <input type=text id=inputLogin class=form-control placeholder="Введите логин" required="" autofocus=""> <label for=inputEmail class=sr-only>E-mail</label> <input type=email id=inputEmail class=form-control placeholder="Введите e-mail\'" required="" autofocus=""> <label for=inputPassword class=sr-only>Пароль</label> <input type=password id=inputPassword class=form-control placeholder="Введите пароль" required=""> <label for=confirmPassword class=sr-only>Подтвердите пароль</label> <input type=password id=confirmPassword class=form-control placeholder="Подтвердите пароль" required=""> <button class="btn btn-lg btn-primary btn-block" type=submit>Зарегистрироваться</button> </form> </div>'},function(e,a,t){"use strict";function n(){var e=this,a=Backbone.View.extend({el:"#content",initialize:function(){this.render()},events:{"submit form.formSingIn":"submitForm","click #signUpBTN":"signUp"},render:function(){this.$el.html(r.a)},submitForm:function(e){var a=$(e.target).find("input#inputLogin").val(),t=$(e.target).find("input#inputPassword").val();return $.post("/login",{username:a,password:t}).done(function(e){window.location.replace("#home")}),!1},signUp:function(){window.location.replace(window.location.href+"#signUp")}});e.view=new a}var i=t(5),r=t.n(i);a.a=n},function(e,a){e.exports='<div class=container> <form class="form-signin formSingIn"> <h2 class=form-signin-heading>Пожалуйста авторизируйтесь:</h2> <label for=inputLogin class=sr-only>Логин</label> <input type=text id=inputLogin class=form-control placeholder="Введите логин" required="" autofocus=""> <label for=inputPassword class=sr-only>Пароль</label> <input type=password id=inputPassword class=form-control placeholder="Введите пароль" required=""> <div class=checkbox> <label> <input type=checkbox value=remember-me> Remember me </label> </div> <button class="btn btn-lg btn-primary btn-block" type=submit>Войти</button> </form> <button class="btn btn-lg btn-info btn-block" id=signUpBTN>Зарегистрироваться</button> </div>'},function(e,a){e.exports='<script type=text/template id=rowTemplate> <tr data-uid="#= uid #" class="#: DateUAHPay&&DateUSDPay  ? \'green\':\'\' #">\r\n        <td>#: MonthToPay ? kendo.toString(new Date(MonthToPay), "MMMM yyyy"):"" #</td>\r\n        <td>#: AccruedSum #</td>\r\n        <td>#: Prepayment #</td>\r\n        <td>#: SumToPay #</td>\r\n        <td class="#: DateUAHPay  ? \'green\':\'\' #">#: SumUAH #</td>\r\n        <td>#: ExchangeRate #</td>\r\n        <td class="#: DateUAHPay ? \'green\':\'\' #">#:DateUAHPay? kendo.toString(new Date(DateUAHPay),"dd MMMM yy"):"" #\r\n        </td>\r\n        <td class="#: DateUSDPay  ? \'green\':\'\' #">#: SumUSD #</td>\r\n        <td class="#: DateUSDPay  ? \'green\':\'\' #">#: DateUSDPay? kendo.toString(new Date(DateUSDPay),"dd MMMM yy"):""\r\n            #\r\n        </td>\r\n        <td><a class="k-button k-button-icontext k-grid-edit" href="\\\\#"><span\r\n                class="k-icon k-edit"></span>Edit</a><a class="k-button k-button-icontext k-grid-delete"\r\n                                                        href="\\\\#"><span\r\n                class="k-icon k-delete"></span>Delete</a>\r\n        </td>\r\n    </tr> <\/script> <script type=text/template id=editWindowTemplate> <div class="k-widget k-window" data-role="draggable"\r\n     style="padding-top: 32.9088px; min-width: 90px; min-height: 50px; top: 173.344px; left: 412px; touch-action: none; z-index: 10003; opacity: 1; transform: scale(1);">\r\n    <div class="k-window-titlebar k-header" style="margin-top: -32.9088px;">&nbsp;<span\r\n            class="k-window-title">Edit</span>\r\n        <div class="k-window-actions"><a role="button" href="#" class="k-window-action k-link"><span role="presentation"\r\n                                                                                                     class="k-icon k-i-close">Close</span></a>\r\n        </div>\r\n    </div>\r\n    <div data-uid="03c454ce-0207-4ed3-8fe7-eaa3602f67d0" class="k-popup-edit-form k-window-content k-content"\r\n         data-role="window" tabindex="0">\r\n        <div class="k-edit-form-container">\r\n            <div class="k-edit-label"><label for="id">id</label></div>\r\n            <div data-container-for="id" class="k-edit-field"><input type="text" class="k-input k-textbox" name="id"\r\n                                                                     data-bind="value:id"></div>\r\n            <div class="k-edit-label"><label for="MonthToPay">Месяц оплаты</label></div>\r\n            <div data-container-for="MonthToPay" class="k-edit-field"><span class="k-widget k-datepicker k-header"><span\r\n                    class="k-picker-wrap k-state-default"><input required="" validationmessage="Заполни дату"\r\n                                                                 name="MonthToPay" data-role="datepicker" type="text"\r\n                                                                 class="k-input" role="combobox" aria-expanded="false"\r\n                                                                 aria-disabled="false" data-bind="value:MonthToPay"\r\n                                                                 style="width: 100%;"><span unselectable="on"\r\n                                                                                            class="k-select"\r\n                                                                                            role="button"><span\r\n                    unselectable="on" class="k-icon k-i-calendar">select</span></span></span></span></div>\r\n            <div class="k-edit-label"><label for="AccruedSum">Сумма начислено</label></div>\r\n            <div data-container-for="AccruedSum" class="k-edit-field"><input class="k-input k-textbox" required=""\r\n                                                                             min="100"\r\n                                                                             validationmessage="Заполни сумму ЗП"\r\n                                                                             name="AccruedSum"\r\n                                                                             data-bind="value:AccruedSum"></div>\r\n            <div class="k-edit-label"><label for="SumToPay">Сумма к оплате</label></div>\r\n            <div data-container-for="SumToPay" class="k-edit-field"><input class="k-input k-textbox" disabled="disabled"\r\n                                                                           min="100"\r\n                                                                           validationmessage="Заполни сумму ЗП"\r\n                                                                           name="SumToPay" data-bind="value:SumToPay">\r\n            </div>\r\n            <div class="k-edit-label"><label for="Prepayment">Сумма аванса</label></div>\r\n            <div data-container-for="Prepayment" class="k-edit-field"><input type="text" class="k-input k-textbox"\r\n                                                                             name="Prepayment"\r\n                                                                             data-bind="value:Prepayment"></div>\r\n            <div class="k-edit-label"><label for="SumUAH">Сумма гривен</label></div>\r\n            <div data-container-for="SumUAH" class="k-edit-field"><input type="text" class="k-input k-textbox"\r\n                                                                         name="SumUAH" data-bind="value:SumUAH"></div>\r\n            <div class="k-edit-label"><label for="ExchangeRate">Курс</label></div>\r\n            <div data-container-for="ExchangeRate" class="k-edit-field"><input type="text" class="k-input k-textbox"\r\n                                                                               name="ExchangeRate"\r\n                                                                               data-bind="value:ExchangeRate"></div>\r\n            <div class="k-edit-label"><label for="DateUAHPay">Дата получения UAH</label></div>\r\n            <div data-container-for="DateUAHPay" class="k-edit-field"><span class="k-widget k-datepicker k-header"><span\r\n                    class="k-picker-wrap k-state-default"><input validationmessage="Заполни дату" name="DateUAHPay"\r\n                                                                 data-role="datepicker" type="text" class="k-input"\r\n                                                                 role="combobox" aria-expanded="false"\r\n                                                                 aria-disabled="false" data-bind="value:DateUAHPay"\r\n                                                                 style="width: 100%;"><span unselectable="on"\r\n                                                                                            class="k-select"\r\n                                                                                            role="button"><span\r\n                    unselectable="on" class="k-icon k-i-calendar">select</span></span></span></span></div>\r\n            <div class="k-edit-label"><label for="SumUSD">Сумма USD</label></div>\r\n            <div data-container-for="SumUSD" class="k-edit-field"><input type="text" class="k-input k-textbox"\r\n                                                                         name="SumUSD" data-bind="value:SumUSD"></div>\r\n            <div class="k-edit-label"><label for="DateUSDPay">Дата получения USD</label></div>\r\n            <div data-container-for="DateUSDPay" class="k-edit-field"><span class="k-widget k-datepicker k-header"><span\r\n                    class="k-picker-wrap k-state-default"><input validationmessage="Заполни дату" name="DateUSDPay"\r\n                                                                 data-role="datepicker" type="text" class="k-input"\r\n                                                                 role="combobox" aria-expanded="false"\r\n                                                                 aria-disabled="false" data-bind="value:DateUSDPay"\r\n                                                                 style="width: 100%;"><span unselectable="on"\r\n                                                                                            class="k-select"\r\n                                                                                            role="button"><span\r\n                    unselectable="on" class="k-icon k-i-calendar">select</span></span></span></span></div>\r\n            <div class="k-edit-label"><label for="undefined"></label></div>\r\n            <div class="k-edit-field"></div>\r\n            <div class="k-edit-buttons k-state-default"><a class="k-button k-button-icontext k-primary k-grid-update"\r\n                                                           href="#"><span class="k-icon k-update"></span>Update</a><a\r\n                    class="k-button k-button-icontext k-grid-cancel" href="#"><span class="k-icon k-cancel"></span>Cancel</a>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div> <\/script>'}]);